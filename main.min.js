var calcsand;(function(n){function ii(){Object.extend(),wt(),b.onorientationchange=wt,b.onkeypress=ri,b.ontouchstart=ui,b.ontouchmove=fi,b.ontouchend=ei}function wt(){function n(){v.attr({width:c,height:h}),ft.style("font-size",Math.max(c,h)/20+"px"),ot(),st(),ti.attr({x:c/2,y:h*.955}),ft.attr({x:c/2,y:h*.055}),window.scrollTo(0,1),it(),oi()}var t=b.orientation||0;c=window.innerWidth,h=window.innerHeight,setTimeout(n,100)}function ri(n){var r=n.which,t=String.fromCharCode(r),i="";bt(t)&&(i=t),kt(t)&&(i=t),(r==13||t=="=")&&(i=f.EQUALS),t=="b"&&(i=f.BACKSPACE),t=="c"&&(i=f.CLEAR),t=="|"&&(i=f.SEPARATE),tt(i)}function ui(n){var t,i;for(n.preventDefault(),t=n.changedTouches.length;t--;)i=n.changedTouches[t].identifier,p[i]=n.changedTouches[t].clone(),p[i].timestamp=Date.now();et(n.touches).enter().append("line").attr("class","touch").attr("x1",function(n){return n.clientX}).attr("y1",function(n){return n.clientY}).attr("x2",function(n){return n.clientX}).attr("y2",function(n){return n.clientY}).style("fill","none").transition().ease("elastic").attr("stroke-width",Math.max(h,c)/10).attr("opacity",.2)}function fi(n){n.preventDefault(),et(n.touches).attr("x1",function(n){return n.clientX}).attr("y1",function(n){return n.clientY}).attr("x2",function(n){return n.clientX}).attr("y2",function(n){return n.clientY})}function ei(n){function i(n){t.classed("touch",null),tt(n)}var o,s,h;n.preventDefault();var r=lt*.05,b=n.touches.length,t=et(n.touches).exit(),u=t[0].length,e=n.changedTouches[0];if(!(b>0)&&(t.classed("touch",null),u!=0)){if(u==2){var c=0,l=1,a=t.data()[c].identifier,v=t.data()[l].identifier,y=dt(p[a].clientX,p[a].clientY,p[v].clientX,p[v].clientY),w=dt(t.data()[c].clientX,t.data()[c].clientY,t.data()[l].clientX,t.data()[l].clientY);if(y-w>r){i(f.ADD);return}if(w-y>r){i(f.SUBTRACT);return}}else if(u==1)if(o=e.clientY-p[e.identifier].clientY,s=e.clientX-p[e.identifier].clientX,Math.abs(o)>=Math.abs(s)){if(o<-r){i(f.SEPARATE);return}if(o>r){i(f.CLEAR);return}}else{if(s>r){i(f.EQUALS);return}if(s<-r){i(f.BACKSPACE);return}}for(h=0;h<(u+"").length;h++)i((u+"").substr(h,1))}}function et(n){return v.selectAll("line.touch").data(n,function(n){return n.identifier})}function ot(n,t){typeof n=="undefined"&&(n=0),typeof t=="undefined"&&(t=0),t=t||(o.length?1:u.length?2:1),n=n||(o.length||Math.max(e.length,u.length))+1,l=c/n,a=Math.min(h/t,h*.4),l=Math.min(l,a),a=Math.min(l,a),rt=0,ut=a*.05,l-=rt*2,a-=ut*2,at=c/2,d=h/2,vt=l/2,yt=a/2,g=l+rt*2,k=a+ut*2,gt=g/2,ni=k/2}function st(){var t=Math.max(e.length,u.length),n=1;u.length&&(n=2),e.length&&s.length&&(n=2),e.length&&y.length&&(n=2),o.length&&(t=o.length,n=1),pt=Math.round(at-t*vt),nt=Math.round(d-n*yt)}function oi(){d3.selectAll("rect").remove();var n=h*.02;v.append("rect").attr({"class":"border",x:0,y:0,width:c,height:n}),v.append("rect").attr({"class":"border",x:0,y:h-n,width:c,height:n}),v.append("rect").attr({"class":"border",x:0,y:0,width:n,height:h}),v.append("rect").attr({"class":"border",x:c-n,y:0,width:n,height:h})}function tt(n){function t(){var t=o;ht(),s=n,e=t}if(n==f.CLEAR&&ht(),n==f.BACKSPACE){if(o.length){tt(f.CLEAR);return}u.length?u=u.slice(0,-1):e.length?e=e.slice(0,-1):s.length?s="":y.length&&(y="")}bt(n)&&(o.length&&ht(),y.length?u+=n:e+=n,e.length>2&&(e=e.slice(0,2)),u.length>2&&(u=u.slice(0,2))),n==f.SEPARATE&&(o.length&&t(),y=f.SEPARATE),kt(n)&&(s=n,o.length&&t(),e.length&&u.length&&s.length&&o.length==0?w=f.EQUALS:e.length&&(y=f.SEPARATE,u.length&&(w=f.EQUALS))),n==f.EQUALS&&(w=f.EQUALS),e.length&&s.length&&u.length&&w.length&&si(),hi()}function si(){try{o=Math.round(eval(e+s+u))+""}catch(e){o=""}}function ht(){e="",u="",s="",y="",w="",o="",r=[]}function hi(){ci(),s=="-"&&o.length?(ct(o,u),it(500,0),ot(),st(),ct(o),it(500,500)):(ot(),st(),ct(e,u,o),it(500,0))}function ci(){var n="";n+=e+"",n+=s+u+""?s||"_":y+u+""?f.SEPARATE:"",n+=s+u+""?u||"_":"",n+=w+"",n+=w?o+""||"_":"",ft.text(n)}function it(n,t){typeof n=="undefined"&&(n=250),typeof t=="undefined"&&(t=0);var i=v.selectAll("line").data(r);i.enter().append("line").attr("x1",function(n){return(n.x1+n.x2)/2}).attr("x2",function(n){return(n.x1+n.x2)/2}).attr("y1",function(n){return(n.x1+n.x2)/2}).attr("y2",function(n){return(n.x1+n.x2)/2}).attr("opacity",function(){return.1}).attr("stroke-width",function(){return 0}).attr("transform",function(n){return"translate("+n.xoff+","+n.yoff+") scale("+n.s+")"}),i.transition().duration(n).delay(t).attr("x1",function(n){return n.x1}).attr("x2",function(n){return n.x2}).attr("y1",function(n){return n.y1}).attr("y2",function(n){return n.y2}).attr("opacity",function(n){return n.o}).attr("stroke-width",function(n){return n.w}).attr("transform",function(n){return"translate("+n.xoff+","+n.yoff+") scale("+n.s+")"}),i.exit().transition().duration(n).delay(t).attr("opacity",function(){return 0}).attr("stroke-width",function(){return 0}).attr("x1",function(n){return(n.x1+n.x2)/2}).attr("x2",function(n){return(n.x1+n.x2)/2}).attr("y1",function(n){return(n.x1+n.x2)/2}).attr("y2",function(n){return(n.x1+n.x2)/2}),setTimeout(function(){i.exit().remove()},t*2)}function ct(n,u,f){var p,ft,a,b,e;typeof n=="undefined"&&(n=""),typeof u=="undefined"&&(u=""),typeof f=="undefined"&&(f=""),r=[];var v=n,y=u,tt=f,it=[];v=Array(Math.max(y.length-v.length+1,0)).join(" ")+(v+""),y=Array(Math.max(v.length-y.length+1,0)).join(" ")+(y+""),it=tt!=""?[tt]:[v,y];for(var et=Math.max(v.length,y.length,tt.length),rt=et,ut=0,w=1,o=Math.round(l*.05);rt--;)for(w=Math.pow(10,ut),ut++,p=it.length;p--;)for(ft=it[p].substr(rt,1),a=w;a-->0;){b=o*3,e=nt+Math.round(k*p-a*b),e<-d&&(a=Math.floor((-d-nt-k*p)/-b),e=nt+Math.round(k*p-a*b));var s=pt+Math.round(g*rt+g/2*a/w),h=a>0?.1:1,c=(1-a/w).toFixed(2);switch(ft){case".":r.unshift({x1:t(50),y1:i(99),x2:t(50),y2:i(99),xoff:s,yoff:e,o:h,w:o,s:c});break;case"0":r.unshift({x1:t(50),y1:i(50),x2:t(50),y2:i(50),xoff:s,yoff:e,o:h,w:o,s:c});break;case"1":r.unshift({x1:t(50),y1:i(00),x2:t(50),y2:i(99),xoff:s,yoff:e,o:h,w:o,s:c});break;case"2":r.unshift({x1:t(80),y1:i(00),x2:t(20),y2:i(93),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(23),y1:i(99),x2:t(80),y2:i(99),xoff:s,yoff:e,o:h,w:o,s:c});break;case"3":r.unshift({x1:t(20),y1:i(00),x2:t(75),y2:i(44),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(73),y1:i(50),x2:t(20),y2:i(50),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(75),y1:i(56),x2:t(20),y2:i(99),xoff:s,yoff:e,o:h,w:o,s:c});break;case"4":r.unshift({x1:t(20),y1:i(00),x2:t(20),y2:i(45),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(25),y1:i(50),x2:t(75),y2:i(50),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(80),y1:i(55),x2:t(80),y2:i(99),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(80),y1:i(00),x2:t(80),y2:i(45),xoff:s,yoff:e,o:h,w:o,s:c});break;case"5":r.unshift({x1:t(80),y1:i(00),x2:t(25),y2:i(00),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(20),y1:i(05),x2:t(20),y2:i(45),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(25),y1:i(50),x2:t(75),y2:i(50),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(80),y1:i(55),x2:t(80),y2:i(95),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(75),y1:i(99),x2:t(20),y2:i(99),xoff:s,yoff:e,o:h,w:o,s:c});break;case"6":r.unshift({x1:t(80),y1:i(00),x2:t(25),y2:i(00),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(20),y1:i(05),x2:t(20),y2:i(45),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(25),y1:i(50),x2:t(75),y2:i(50),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(80),y1:i(55),x2:t(80),y2:i(94),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(75),y1:i(99),x2:t(25),y2:i(99),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(20),y1:i(94),x2:t(20),y2:i(55),xoff:s,yoff:e,o:h,w:o,s:c});break;case"7":r.unshift({x1:t(20),y1:i(25),x2:t(20),y2:i(05),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(25),y1:i(00),x2:t(76),y2:i(00),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(80),y1:i(06),x2:t(35),y2:i(99),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(25),y1:i(50),x2:t(75),y2:i(50),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(80),y1:i(55),x2:t(80),y2:i(70),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(75),y1:i(75),x2:t(25),y2:i(75),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(20),y1:i(70),x2:t(20),y2:i(55),xoff:s,yoff:e,o:h,w:o,s:c});break;case"8":r.unshift({x1:t(75),y1:i(30),x2:t(55),y2:i(50),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(55),y1:i(00),x2:t(75),y2:i(20),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(45),y1:i(50),x2:t(25),y2:i(30),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(25),y1:i(20),x2:t(45),y2:i(00),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(25),y1:i(61),x2:t(75),y2:i(61),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(80),y1:i(66),x2:t(80),y2:i(94),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(75),y1:i(99),x2:t(25),y2:i(99),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(20),y1:i(94),x2:t(20),y2:i(66),xoff:s,yoff:e,o:h,w:o,s:c});break;case"9":r.unshift({x1:t(75),y1:i(00),x2:t(25),y2:i(00),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(20),y1:i(05),x2:t(20),y2:i(45),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(25),y1:i(50),x2:t(75),y2:i(50),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(80),y1:i(45),x2:t(80),y2:i(05),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(54),y1:i(05),x2:t(70),y2:i(22),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(70),y1:i(28),x2:t(54),y2:i(45),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(48),y1:i(45),x2:t(31),y2:i(28),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(31),y1:i(22),x2:t(48),y2:i(05),xoff:s,yoff:e,o:h,w:o,s:c}),r.unshift({x1:t(80),y1:i(55),x2:t(50),y2:i(99),xoff:s,yoff:e,o:h,w:o,s:c})}}}function t(n){return Math.round(n*l/100)}function i(n){return Math.round(n*a/100)}function bt(n){return"1234567890".indexOf(n)>=0}function kt(n){return n.length&&"*-+/".indexOf(n)>=0}function dt(n,t,i,r){return Math.sqrt(Math.pow(i-n,2)+Math.pow(r-t,2))}var e="",u="",s="",o="",y="",w="",r=[],f={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",DECIMAL:".",ADD:"+",SUBTRACT:"-",MULTIPLY:"*",DIVIDE:"/",EQUALS:"=",CLEAR:"c",SEPARATE:"|",BACKSPACE:"b"},lt=1024,b=window,li=document.getElementsByTagName("body")[0],p=[],l,a,rt,ut,at,d,vt,yt,g,k,gt,ni,c=768,h=lt,pt,nt,v=d3.select("svg"),ft=v.append("text"),ti=v.append("text");ii(),n.processInput=tt})(calcsand||(calcsand={}))